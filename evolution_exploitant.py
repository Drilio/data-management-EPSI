import pandas as pd
import matplotlib.pyplot as plt

file_path = "./dataSet.xlsx"
df = pd.read_excel(file_path, sheet_name=3)

df['annee'] = pd.to_numeric(df['annee'], errors='coerce')

evolution_exploitant = df.groupby('annee')['nb_exp'].sum()

plt.figure(figsize=(10, 6))
evolution_exploitant.plot(kind="line", marker="o", linestyle="-", color="blue")
plt.title("Evolution of Bio Agricole Workers Over Years in France")
plt.xlabel("Year")
plt.ylabel("Number of Workers")
plt.grid(axis="y", linestyle="--", alpha=0.7)
plt.xticks(evolution_exploitant.index, rotation=45)
plt.tight_layout()

# Save and show the plot
plt.savefig("evolution_over_years.png", dpi=300)
plt.show()
